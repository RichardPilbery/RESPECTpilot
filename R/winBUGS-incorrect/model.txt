# This model is based on that published in Volume 2 of the winBUGS manual (http://www.mrc-bsu.cam.ac.uk/wp-content/uploads/WinBUGS_Vol2.pdf)
# Refer to the analysis of Breslow and Day(1980): Endo: conditional inference in case-control studies, page 35â€“37


model	{	# PRIORS		beta ~ dnorm(0,1.0E-6) ;    	      ecgvar<-pow(sde,-2);	      subjvar<-pow(sds,-2)	      sde~dunif(0,5)	      sds~dunif(0,5)	  	# LIKELIHOOD	#random effects	for (ii in 1:S){	sub[ii]~dnorm(0,subjvar)	}	for (ij in 1:E){	ecg[ij]~dnorm(0,ecgvar)	}		for (i in 1 : N) {                    # loop around strata			# METHOD 1 - logistic regression	           t[i,2] ~ dbin( p[i,1], 1) 		        logit(p[i,1]) <- beta * (t[i,6] - t[i,7])+ecg[t[i,5]]*(t[i,6]-t[i,7])+sub[t[i,4]]*(t[i,6]-t[i,7])		# METHOD 2 - conditional likelihoods		 	#      Y[i, 1 : J] ~ dmulti( p[i, 1 : J],1)		 	 #      for (j in 1:2){		 	#	     p[i, j] <- e[i, j] / sum(e[i, ])		# 		#	     log( e[i, j] ) <- beta * est[i, j] 		 	      }         		# METHOD 3 fit standard Poisson regressions relative to baseline		#        for (j in 1:J) {     		#            Y[i, j] ~ dpois(mu[i, j]);		#            log(mu[i, j]) <- beta0[i] +  beta*est[i, j]; 		#        } 		#	    beta0[i] ~ dnorm(0, 1.0E-6) 	}}